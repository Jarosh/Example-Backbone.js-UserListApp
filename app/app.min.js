(function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;window.AppRouter=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.prototype.$container=$("#app"),c.prototype.routes={"":"viewUserListing",users:"viewUserListing","users/:id":"viewUserDetails"},c.prototype.initialize=function(){return this.collection_user=new CUser(null,{mode:"client",state:{pageSize:5}}),this.collection_user.fetch(),this.viewUserListing(),Backbone.history.start({root:"/",pushState:!0}),window.onpopstate=function(a){return function(){return APP.INST.navigate(Backbone.history.fragment,!0)}}(this),$(document).on("click","a:not([data-bypass])",function(a){var b,c;if(b=$(this).attr("href"),c=this.protocol+"//",b.slice(c.length)!==c)return a.preventDefault(),APP.INST.navigate(b,!0)})},c.prototype.viewUserListing=function(){return this.$container.html(new VUserListing({collection:this.collection_user}).render().el)},c.prototype.viewUserDetails=function(a){return this.$container.html(new VUserDetails({collection:this.collection_user,id:a}).render().el)},c}(Backbone.Router)}).call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;window.MUser=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.prototype.defaults={name:"",username:"",email:"",phone:"",website:"",address:{street:"",suite:"",city:"",zipcode:""}},c.prototype.validate=function(a){var b;return b=[],a.email?a.email.match(/^\S+@\S+$/)||b.push({name:"email",message:"Please enter a valid email."}):b.push({name:"email",message:"Please fill email field."}),a.website?a.website.match(/^[A-Za-z0-9_-]+(\.[A-Za-z0-9_-]+)+$/)||b.push({name:"website",message:"Please enter a valid website (domain name only)."}):b.push({name:"website",message:"Please fill website field."}),!!b.length&&b},c}(Backbone.Model)}.call(this),function(){var a=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a},b={}.hasOwnProperty;window.CUser=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return a(c,b),c.prototype.model=MUser,c.prototype.url=APP.HOST.api+"/users",c.prototype.initialize=function(a,b){},c}(Backbone.PageableCollection)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},c={}.hasOwnProperty;window.VAddress=function(c){function d(){return this.render=a(this.render,this),d.__super__.constructor.apply(this,arguments)}return b(d,c),d.prototype.initialize=function(a){return this.options=a,this.render()},d.prototype.template=function(a){return _.template(jQuery("#Address").html())(a)},d.prototype.render=function(){return $(this.el).html(this.template({address:this.options.address})),this},d}(Backbone.View)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},c={}.hasOwnProperty;window.VUserDetails=function(c){function d(){return this.render=a(this.render,this),d.__super__.constructor.apply(this,arguments)}return b(d,c),d.prototype.events={"click .btn-edit":"onEdit","click .btn-save":"onSave","click .btn-cancel":"onCancel","input input":"onChange"},d.prototype.initialize=function(a){return this.options=a,this.collection.on("sync",this.render),this.render()},d.prototype.onEdit=function(a){return $(this.el).find(".editable").removeClass("mode-show").addClass("mode-edit")},d.prototype.onSave=function(a){var b,c;if($(a.target).attr("disabled",!0),b=$(a.target).closest(".mode-edit").find("input"),c=this.collection.fullCollection.get(this.options.id),c.save({email:$(this.el).find('input[name="email"]').val(),website:$(this.el).find('input[name="website"]').val()},{patch:!0,success:function(){return $(this.el).find(".editable").removeClass("mode-edit").addClass("mode-show")},error:function(a,b){return alert("An unexpected error occurred.")}}),c.validationError)return this.showErrors(c.validationError),$(a.target).attr("disabled",!1)},d.prototype.onCancel=function(a){return this.render()},d.prototype.onChange=function(a){return $(a.target).closest(".mode-edit").removeClass("mode-error").find(".error").html("")},d.prototype.showErrors=function(a){return $(this.el).find(".mode-error").removeClass("mode-error").find(".error").html(""),_.each(a,function(a){return function(b){return $(a.el).find('input[name="'+b.name+'"]').closest(".mode-edit").addClass("mode-error").find(".error").html(b.message)}}(this))},d.prototype.template=function(a){return _.template(jQuery("#UserDetails").html())(a)},d.prototype.render=function(){var a;return this.collection.length&&(a=this.collection.fullCollection.get(this.options.id),$(this.el).html(this.template({user:a})),new VAddress({el:$(this.el).find(".VAddress"),address:a.get("address")})),this},d}(Backbone.View)}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},c={}.hasOwnProperty;window.VUserListing=function(c){function d(){return this.render=a(this.render,this),d.__super__.constructor.apply(this,arguments)}return b(d,c),d.prototype.events={"click .page":"onPaginate"},d.prototype.initialize=function(a){return this.options=a,this.collection.on("sync",this.render),this.render()},d.prototype.onPaginate=function(a){return this.collection.state.currentPage=parseInt($(a.target).attr("data-page")),this.render()},d.prototype.template=function(a){return _.template(jQuery("#UserListing").html())(a)},d.prototype.renderPagination=function(){return _.template(jQuery("#Paginator").html())({collection:this.collection})},d.prototype.render=function(){return $(this.el).html(this.template({collection:this.collection,pagination:this.renderPagination()})),this},d}(Backbone.View)}.call(this);